

# This file was *autogenerated* from the file ctf/crypto/modern/asymmetric/rsa/ex_wiener.sage
from sage.all_cmdline import *   # import sage library

_sage_const_8634199943296266475661694936017797245643751574377300702352556698923010846293195618475931386615270566178369671247793107594356541948964368726568708230319186988913696138400127564811132791236599834089885854076690263057534834835449605382639029368521956753682831912247745557625558315338427219091935188588303976619473720984938018512720749790101691789367840457806658319810844865267910935154626575220525191686503490303606772840181902374949090928479931214664359010094218789662306484000672754511863044300205945846244848169672310913442059177294181486468799409873093284267766706986492607452210174334940756036650337736844394789495 = Integer(8634199943296266475661694936017797245643751574377300702352556698923010846293195618475931386615270566178369671247793107594356541948964368726568708230319186988913696138400127564811132791236599834089885854076690263057534834835449605382639029368521956753682831912247745557625558315338427219091935188588303976619473720984938018512720749790101691789367840457806658319810844865267910935154626575220525191686503490303606772840181902374949090928479931214664359010094218789662306484000672754511863044300205945846244848169672310913442059177294181486468799409873093284267766706986492607452210174334940756036650337736844394789495); _sage_const_12901756511557359459621054599419970335607988670582154586781205445748574407546618457098103159759328515721549039134014014073709913358229236019318189779818263730049449609355323855082266380391015183886428125925985343445384430401311570859272506454200233455063271055549547787458600678939380630979924929901900873350761446538288165222899228547734019705071658914556199926875965160081841955409321412403297397976671464079113812960712232880728456020030552116088590712831093055816879053205775173702025585694098709855246718301238931312541326436602594881624659659457608825023680534566306520148778474705123992253089763243470479950233 = Integer(12901756511557359459621054599419970335607988670582154586781205445748574407546618457098103159759328515721549039134014014073709913358229236019318189779818263730049449609355323855082266380391015183886428125925985343445384430401311570859272506454200233455063271055549547787458600678939380630979924929901900873350761446538288165222899228547734019705071658914556199926875965160081841955409321412403297397976671464079113812960712232880728456020030552116088590712831093055816879053205775173702025585694098709855246718301238931312541326436602594881624659659457608825023680534566306520148778474705123992253089763243470479950233); _sage_const_977911319972651723394571328718522684839233818822987291339342522169785960745026126065828171663817098096802815878902198077029945858855452998609277456106194388819262956948062693982275761329872056054857859232410277612711142700816736355176841064088554319372770630155715384207807030711333354763745992705118120370569460710155977842815890921315491899909670843778015790583691632043993431476520040474179224148193231997414071665994798409600593324091379931314280308037578462983918490074229956220561677028253942457235006713182547923616926990304799750998947455658072553806135348762275048940937102270212197438343232803386980600199 = Integer(977911319972651723394571328718522684839233818822987291339342522169785960745026126065828171663817098096802815878902198077029945858855452998609277456106194388819262956948062693982275761329872056054857859232410277612711142700816736355176841064088554319372770630155715384207807030711333354763745992705118120370569460710155977842815890921315491899909670843778015790583691632043993431476520040474179224148193231997414071665994798409600593324091379931314280308037578462983918490074229956220561677028253942457235006713182547923616926990304799750998947455658072553806135348762275048940937102270212197438343232803386980600199); _sage_const_559926877538901855278709098896162376244891138092491748881646434257041034310608383824407908074527674643899150895417313223110172168262601307071421399851733600345246010968366031770769952148466575159479327201407370870373866834887618577577208326983314970874299883828509623859285236698607654392197001359543187659277514383894861161291255994103416260263908568346256404585813409981064816508457745463277226433109583627383451707715853470546862943671380153218903698760690215786348972308030107405803386360872526435918433010695648728609011716822060677651971222925334030992502934274269358900515685347824060069702996792263218410141 = Integer(559926877538901855278709098896162376244891138092491748881646434257041034310608383824407908074527674643899150895417313223110172168262601307071421399851733600345246010968366031770769952148466575159479327201407370870373866834887618577577208326983314970874299883828509623859285236698607654392197001359543187659277514383894861161291255994103416260263908568346256404585813409981064816508457745463277226433109583627383451707715853470546862943671380153218903698760690215786348972308030107405803386360872526435918433010695648728609011716822060677651971222925334030992502934274269358900515685347824060069702996792263218410141); _sage_const_1306404425022786271861712376312227231552124703867069879929901082879590329712646841443187584387062880868763681811151633406488565216662438202954203241832546481831672169351320530897609760536461880974100913848321066609914696142148451258661558034664208629457074290198874188404392722618650477272549474176737297639391121777399834751032698170461874404735298259292915012795056598770703384560299787009329290972427164924620081023359665839557541169147316521214789391267972983251818403995447818247440728403270006177653413374374454715842733972395479437016747743514743563369659891600826890121796921748619451887714168425727577340049 = Integer(1306404425022786271861712376312227231552124703867069879929901082879590329712646841443187584387062880868763681811151633406488565216662438202954203241832546481831672169351320530897609760536461880974100913848321066609914696142148451258661558034664208629457074290198874188404392722618650477272549474176737297639391121777399834751032698170461874404735298259292915012795056598770703384560299787009329290972427164924620081023359665839557541169147316521214789391267972983251818403995447818247440728403270006177653413374374454715842733972395479437016747743514743563369659891600826890121796921748619451887714168425727577340049); _sage_const_0 = Integer(0); _sage_const_1 = Integer(1); _sage_const_2 = Integer(2); _sage_const_0p395 = RealNumber('0.395'); _sage_const_3 = Integer(3); _sage_const_65537 = Integer(65537)
from Crypto.Util.number import long_to_bytes
import gmpy2
# # Different parameters for each team
# N = 14922959775784066499316528935316325825140011208871830627653191549546959775167708525042423039865322548420928571524120743831693550123563493981797950912895893476200447083386549353336086899064921878582074346791320104106139965010480614879592357793053342577850761108944086318475849882440272688246818022209356852924215237481460229377544297224983887026669222885987323082324044645883070916243439521809702674295469253723616677245762242494478587807402688474176102093482019417118703747411862420536240611089529331148684440513934609412884941091651594861530606086982174862461739604705354416587503836130151492937714365614194583664241
# e2 = 27188825731727584656624712988703151030126350536157477591935558508817722580343689565924329442151239649607993377452763119541243174650065563589438911911135278704499670302489754540301886312489410648471922645773506837251600244109619850141762795901696503387880058658061490595034281884089265487336373011424883404499124002441860870291233875045675212355287622948427109362925199018383535259913549859747158348931847041907910313465531703810313472674435425886505383646969400166213185676876969805238803587967334447878968225219769481841748776108219650785975942208190380614555719233460250841332020054797811415069533137170950762289
# e1 = 114552459553730357961013268333698879659007919035942930313432809776799669181481660306531243618160127922304264986001501784564575128319884991774542682853466808329973362019677284072646678280051091964555611220961719302320547405880386113519147076299481594997799884384012548506240748042365643212774215730304047871679706035596550898944580314923260982768858133395187777029914150064371998328788068888440803565964567662563652062845388379897799506439389461619422933318625765603423604615137217375612091221578339493263160670355032898186792479034771118678394464854413824347305505135625135428816394053078365603937337271798774138959
# c = 6472367338832635906896423990323542537663849304314171581554107495210830026660211696089062916158894195561723047864604633460433867838687338370676287160274165915800235253640690510046066541445140501917731026596427080558567366267665887665459901724487706983166070740324307268574128474775026837827907818762764766069631267853742422247229582756256253175941899099898884656334598790711379305490419932664114615010382094572854799421891622789614614720442708271653376485660139560819668239118588069312179293488684403404385715780406937817124588773689921642802703005341324008483201528345805611493251791950304129082313093168732415486813
c = _sage_const_8634199943296266475661694936017797245643751574377300702352556698923010846293195618475931386615270566178369671247793107594356541948964368726568708230319186988913696138400127564811132791236599834089885854076690263057534834835449605382639029368521956753682831912247745557625558315338427219091935188588303976619473720984938018512720749790101691789367840457806658319810844865267910935154626575220525191686503490303606772840181902374949090928479931214664359010094218789662306484000672754511863044300205945846244848169672310913442059177294181486468799409873093284267766706986492607452210174334940756036650337736844394789495 
N = _sage_const_12901756511557359459621054599419970335607988670582154586781205445748574407546618457098103159759328515721549039134014014073709913358229236019318189779818263730049449609355323855082266380391015183886428125925985343445384430401311570859272506454200233455063271055549547787458600678939380630979924929901900873350761446538288165222899228547734019705071658914556199926875965160081841955409321412403297397976671464079113812960712232880728456020030552116088590712831093055816879053205775173702025585694098709855246718301238931312541326436602594881624659659457608825023680534566306520148778474705123992253089763243470479950233 
elist = [_sage_const_977911319972651723394571328718522684839233818822987291339342522169785960745026126065828171663817098096802815878902198077029945858855452998609277456106194388819262956948062693982275761329872056054857859232410277612711142700816736355176841064088554319372770630155715384207807030711333354763745992705118120370569460710155977842815890921315491899909670843778015790583691632043993431476520040474179224148193231997414071665994798409600593324091379931314280308037578462983918490074229956220561677028253942457235006713182547923616926990304799750998947455658072553806135348762275048940937102270212197438343232803386980600199 , _sage_const_559926877538901855278709098896162376244891138092491748881646434257041034310608383824407908074527674643899150895417313223110172168262601307071421399851733600345246010968366031770769952148466575159479327201407370870373866834887618577577208326983314970874299883828509623859285236698607654392197001359543187659277514383894861161291255994103416260263908568346256404585813409981064816508457745463277226433109583627383451707715853470546862943671380153218903698760690215786348972308030107405803386360872526435918433010695648728609011716822060677651971222925334030992502934274269358900515685347824060069702996792263218410141 , _sage_const_1306404425022786271861712376312227231552124703867069879929901082879590329712646841443187584387062880868763681811151633406488565216662438202954203241832546481831672169351320530897609760536461880974100913848321066609914696142148451258661558034664208629457074290198874188404392722618650477272549474176737297639391121777399834751032698170461874404735298259292915012795056598770703384560299787009329290972427164924620081023359665839557541169147316521214789391267972983251818403995447818247440728403270006177653413374374454715842733972395479437016747743514743563369659891600826890121796921748619451887714168425727577340049 ]
e1,e2,e3 = elist[_sage_const_0 ],elist[_sage_const_1 ],elist[_sage_const_2 ]
a = _sage_const_0p395 
# M1 = N**0.5
# M2 = N**(1+a)
# D = diagonal_matrix(ZZ, [N, M1, M2, 1])
D = diagonal_matrix(ZZ, [int(N**(_sage_const_3 /_sage_const_2 )), N, int(N**(_sage_const_3 /_sage_const_2 +a)), int(N**(_sage_const_1 /_sage_const_2 )), int(N**(_sage_const_3 /_sage_const_2 +a)), int(N**(_sage_const_1 +a)), int(N**(_sage_const_1 +a)), _sage_const_1 ])
'''
B = Matrix(ZZ, [[1, -N,   0,  N**2],
                [0, e1, -e1, -e1*N],
                [0,  0,  e2, -e2*N],
                [0,  0,   0, e1*e2]]) * D
'''
B = Matrix(ZZ, [[_sage_const_1 ,  -N,  _sage_const_0 ,    N**_sage_const_2 ,   _sage_const_0 ,      _sage_const_0 ,      _sage_const_0 ,     -N**_sage_const_3 ],
                [_sage_const_0 ,  e1, -e1, -e1*N, -e1,      _sage_const_0 ,   e1*N,   e1*N**_sage_const_2 ],
                [_sage_const_0 ,   _sage_const_0 ,  e2, -e2*N,   _sage_const_0 ,   e2*N,      _sage_const_0 ,   e2*N**_sage_const_2 ],
                [_sage_const_0 ,   _sage_const_0 ,   _sage_const_0 , e1*e2,   _sage_const_0 , -e1*e2, -e1*e2, -e1*e2*N],
                [_sage_const_0 ,   _sage_const_0 ,   _sage_const_0 ,     _sage_const_0 ,  e3,  -e3*N,  -e3*N,   e3*N**_sage_const_2 ],
                [_sage_const_0 ,   _sage_const_0 ,   _sage_const_0 ,     _sage_const_0 ,   _sage_const_0 ,  e1*e3,      _sage_const_0 , -e1*e3*N],
                [_sage_const_0 ,   _sage_const_0 ,   _sage_const_0 ,     _sage_const_0 ,   _sage_const_0 ,      _sage_const_0 ,  e2*e3, -e2*e3*N],
                [_sage_const_0 ,   _sage_const_0 ,   _sage_const_0 ,     _sage_const_0 ,   _sage_const_0 ,      _sage_const_0 ,      _sage_const_0 , e1*e2*e3]]) * D
L = B.LLL()
v = Matrix(ZZ, L[_sage_const_0 ])
x = v * B**(-_sage_const_1 )
phi = int(x[_sage_const_0 ,_sage_const_1 ]/x[_sage_const_0 ,_sage_const_0 ]*e1)

d = inverse_mod(_sage_const_65537 , phi)
print(long_to_bytes(pow(c,d,N)))

